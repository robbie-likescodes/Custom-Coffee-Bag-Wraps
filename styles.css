/* ========== Root tokens ==========
   Dark-first palette with accessible contrast.
   You can swap to a light theme by toggling .theme-light on <body>.
*/
:root{
  --bg:#0e0e0e;
  --panel:#121316;
  --ink:#f3f4f6;
  --muted:#a3a7ad;
  --line:#23272d;
  --accent:#de3a3a;
  --focus:#3aa6ff;

  --radius:12px;
  --radius-sm:10px;
  --shadow:0 2px 10px rgba(0,0,0,.25);
  --transition:200ms ease;
  --font:14px/1.45 Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
}

body.theme-light{
  --bg:#f7f6f3;
  --panel:#ffffff;
  --ink:#0e0e0e;
  --muted:#5c6269;
  --line:#dcdfe3;
  --accent:#c43232;
  --focus:#246bff;
}

/* ========== Base ========== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--ink);
  font:var(--font);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* Scrollbar (WebKit) */
*::-webkit-scrollbar{width:10px;height:10px}
*::-webkit-scrollbar-thumb{background:#2a2f35;border-radius:99px}
*::-webkit-scrollbar-track{background:transparent}

/* Links */
a{color:var(--ink); text-decoration:none}
a:hover{text-decoration:underline}

/* ========== Topbar ========== */
.topbar{
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 14px;
  border-bottom:1px solid var(--line);
  background:color-mix(in oklab, var(--bg) 96%, black);
  position:sticky; top:0; z-index:10;
}
.topbar h1{margin:0; font-size:16px; letter-spacing:.5px}
.actions{display:flex; gap:8px; align-items:center}

/* ========== Buttons ========== */
.btn{
  display:inline-flex; align-items:center; justify-content:center;
  gap:8px;
  padding:9px 12px;
  border:1px solid var(--line);
  background:var(--panel);
  color:var(--ink);
  border-radius:var(--radius-sm);
  cursor:pointer;
  transition:border-color var(--transition), background var(--transition), transform var(--transition);
  user-select:none;
}
.btn:hover{border-color:#3a4047}
.btn:active{transform:translateY(1px)}
.btn.primary{background:var(--accent); border-color:var(--accent); color:#fff}
.btn.ghost{background:transparent}
.btn[disabled], .btn:disabled{opacity:.5; cursor:not-allowed}

/* Focus ring */
:focus-visible{
  outline:2px solid var(--focus);
  outline-offset:2px;
  border-radius:8px;
}

/* ========== Layout ========== */
.layout{
  display:grid; grid-template-columns:340px 1fr;
  height:calc(100vh - 52px);
}
.panel{
  overflow:auto; padding:14px;
  border-right:1px solid var(--line);
  background:color-mix(in oklab, var(--bg) 97%, black);
}
.viewport{position:relative; display:grid; place-items:center; background:var(--bg)}

/* ========== Sections (collapsible) ========== */
.section{
  border:1px solid var(--line);
  border-radius:var(--radius);
  margin-bottom:12px;
  background:var(--panel);
  box-shadow:var(--shadow);
}
.section header{
  display:flex; justify-content:space-between; align-items:center;
  padding:10px 12px; cursor:pointer; user-select:none;
}
.section header h3{margin:0; font-size:14px}
.section .content{
  padding:12px; border-top:1px solid var(--line)
}
/* collapsed by default; JS toggles [data-open] */
.section:not([data-open]) .content{display:none}

/* ========== Text & hints ========== */
.panel h2{margin:10px 0 8px}
.panel p{color:var(--muted); margin:8px 0}
.hint{color:var(--muted); font-size:12px}

/* ========== Controls ========== */
.row{display:flex; align-items:center; gap:10px; margin:8px 0}
label.small{width:84px; color:var(--muted)}

input[type="file"],
input[type="color"],
input[type="range"],
input[type="text"],
textarea,
select{
  width:100%;
  background:#121418;
  color:var(--ink);
  border:1px solid var(--line);
  border-radius:var(--radius-sm);
  padding:8px;
  transition:border-color var(--transition), background var(--transition);
}
.theme-light input[type="file"],
.theme-light input[type="color"],
.theme-light input[type="range"],
.theme-light input[type="text"],
.theme-light textarea,
.theme-light select{
  background:#fff;
}
input[type="range"]{padding:0}
input[type="color"]{height:38px}

/* Range track/thumb (WebKit) */
input[type="range"]::-webkit-slider-runnable-track{
  height:6px; background:#2a2f35; border-radius:99px
}
input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance:none; margin-top:-5px; width:16px; height:16px;
  border-radius:50%; background:var(--accent); border:none
}
/* Range (Firefox) */
input[type="range"]::-moz-range-track{
  height:6px; background:#2a2f35; border-radius:99px
}
input[type="range"]::-moz-range-thumb{
  width:16px; height:16px; border-radius:50%;
  background:var(--accent); border:none
}

/* File input nicer hover */
input[type="file"]:hover{border-color:#3a4047}

/* ========== Stickers Grid ========== */
.stickers{
  display:grid; grid-template-columns:repeat(4,1fr); gap:8px
}
.stickers button{
  border:1px solid var(--line); background:#111316;
  border-radius:8px; padding:6px; cursor:pointer; transition:border-color var(--transition)
}
.stickers button:hover{border-color:#3a4047}
.stickers button.active{outline:2px solid var(--accent); outline-offset:2px}
.stickers img{width:100%; aspect-ratio:1/1; object-fit:contain; display:block}

/* ========== Canvases ========== */
#three{width:100%; height:100%; display:block}
#flatCanvas{
  position:absolute; inset:0; width:100%; height:100%; display:none; background:#fff
}

/* ========== Helper cards ========== */
.help{
  margin-top:10px; padding:10px;
  border:1px solid var(--line);
  border-radius:var(--radius);
  background:#121416;
}

/* ========== Toast ========== */
.toast{
  position:fixed; left:50%; transform:translateX(-50%);
  bottom:14px; background:#161a1e; border:1px solid #2a2f35;
  color:#eaecef; padding:10px 14px; border-radius:var(--radius-sm);
  opacity:0; pointer-events:none; transition:opacity var(--transition), transform var(--transition);
  z-index:20;
}
.toast.show{opacity:1}

/* ========== Responsive ========== */
@media (max-width: 980px){
  .layout{grid-template-columns:1fr}
  .panel{order:2; height:52vh}
  .viewport{order:1; height:48vh}
  .actions{flex-wrap:wrap}
}

/* ========== Reduced Motion ========== */
@media (prefers-reduced-motion: reduce){
  *{transition:none !important; animation:none !important}
}

/* ========== Optional: utility ========== */
.hidden{display:none !important}
.sr-only{
  position:absolute !important; width:1px; height:1px;
  padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0;
}
